
# C++ 列表初始化

C++ 的列表初始化（List Initialization）是一种初始化对象的语法，使用花括号 `{}` 来直接提供初始值。列表初始化在 C++11 中引入，目的是简化对象的初始化过程，并增强代码的可读性和安全性。它可以用于初始化数组、标准库容器、类对象等。列表初始化有以下几种形式：

## 1. 直接列表初始化（Direct List Initialization）
通过在对象的定义时，直接使用花括号 `{}` 提供初始化值。

```cpp
int x{10};   // 直接列表初始化
```

## 2. 拷贝列表初始化（Copy List Initialization）
通过赋值的方式，使用花括号 `{}` 提供初始值。

```cpp
int y = {20};   // 拷贝列表初始化
```

## 3. 聚合类型的初始化
对于聚合类型（如数组或结构体），可以使用列表初始化来设置每个成员的初始值。

```cpp
struct Point {
    int x;
    int y;
};

Point p1 = {1, 2};   // 聚合类型的列表初始化
```

## 4. 初始化标准库容器
你可以使用列表初始化来为标准库容器（如 `std::vector`、`std::array`）赋值。

```cpp
std::vector<int> vec = {1, 2, 3, 4, 5};  // 初始化 std::vector
std::array<int, 3> arr = {10, 20, 30};   // 初始化 std::array
```

## 5. 防止隐式类型转换
列表初始化能够防止某些情况下的隐式类型转换。

```cpp
int z{3.14};  // 编译错误，因为3.14是double类型，不允许隐式转换
```

## 6. 空列表初始化
还可以使用空的花括号进行默认初始化。

```cpp
int a{};  // 初始化为 0
```

## 列表初始化的优点
- **避免窄化转换**：列表初始化可以避免从浮点数到整数、从大范围整数到小范围整数等可能导致数据丢失的“窄化转换”。
- **统一的初始化方式**：它为初始化提供了一种统一的语法，适用于基本类型、聚合类型、类对象等。
- **提高代码可读性**：代码的意图更清晰，减少了错误的可能性。

## 示例代码

```cpp
#include <iostream>
#include <vector>

struct Point {
    int x;
    int y;
};

int main() {
    int a{5};              // 直接列表初始化
    std::vector<int> v{1, 2, 3};  // 初始化 std::vector
    Point p{10, 20};       // 初始化结构体 Point

    std::cout << "a: " << a << std::endl;
    std::cout << "v: ";
    for (int i : v) {
        std::cout << i << " ";
    }
    std::cout << std::endl;
    std::cout << "p: (" << p.x << ", " << p.y << ")" << std::endl;

    return 0;
}
```

在这个例子中，`a`、`v` 和 `p` 都是通过列表初始化方式进行赋值的，这使得代码更为简洁和安全。
