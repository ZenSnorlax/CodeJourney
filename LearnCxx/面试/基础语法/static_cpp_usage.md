
# C++ 中 static 的作用及使用场景

## 1. 静态变量（局部变量）
在函数内部声明的 `static` 变量只会在第一次调用时初始化，并且在函数多次调用之间保持其值不变。与普通的局部变量不同，它的生命周期与程序相同，而不是函数调用的生命周期。

```cpp
void counter() {
    static int count = 0; // 只初始化一次
    count++;
    std::cout << count << std::endl;
}
```

**使用场景**：
- 用于在函数调用之间保持状态，例如计数器或缓存。

## 2. 静态全局变量
在全局作用域中声明的 `static` 变量，其作用域限制在声明它的文件内部（即内部链接），其他文件无法访问该变量。它与普通的全局变量不同，具有文件范围的作用域。

```cpp
static int globalVar = 10;
```

**使用场景**：
- 用于在一个文件中定义只在该文件内部可见的全局变量，避免与其他文件中的全局变量命名冲突。

## 3. 静态成员变量（类变量）
在类中声明的 `static` 成员变量属于类本身，而不是类的某个对象。它在所有类的实例中共享，即所有对象共享同一份静态成员变量。静态成员变量需要在类定义外进行初始化。

```cpp
class MyClass {
public:
    static int staticVar;
};

int MyClass::staticVar = 0; // 静态成员变量初始化
```

**使用场景**：
- 用于在所有类的实例之间共享数据，如计数类对象的数量、共享常量等。

## 4. 静态成员函数
静态成员函数与静态成员变量类似，属于类而不是类的某个对象。静态成员函数只能访问静态成员变量或其他静态成员函数，不能访问非静态成员。

```cpp
class MyClass {
public:
    static void staticFunction() {
        std::cout << "This is a static function." << std::endl;
    }
};

MyClass::staticFunction(); // 通过类调用静态成员函数
```

**使用场景**：
- 用于实现不依赖于具体对象的功能，例如工厂方法或实用工具函数。

## 5. 静态函数（文件内静态函数）
在函数声明前加上 `static` 关键字，可以将该函数的作用域限制在定义它的文件内部，即该函数具有内部链接性，其他文件无法调用这个函数。

```cpp
static void helperFunction() {
    std::cout << "This function is only visible in this file." << std::endl;
}
```

**使用场景**：
- 用于在某个文件中实现只在该文件内部使用的辅助函数，防止命名冲突。

## 总结
- **静态局部变量**：在函数中保持状态，生命周期与程序相同。
- **静态全局变量**：限制全局变量的作用域，使其仅在声明的文件内可见。
- **静态成员变量**：在所有类的对象之间共享，表示类级别的数据。
- **静态成员函数**：用于操作静态成员变量或实现与对象无关的功能。
- **静态函数**：用于文件内的辅助功能，限制函数作用域在文件内部。

通过合理使用 `static`，可以提高程序的模块化、数据共享控制以及命名冲突的避免。
