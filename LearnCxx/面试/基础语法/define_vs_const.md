
# C++ 中 `#define` 和 `const` 的区别

在 C++ 中，`#define` 和 `const` 都可以用来定义常量，但它们有一些重要的区别：

## 1. 语法层面
- **`#define`**: 是一个预处理指令，用来定义宏。编译器在编译之前由预处理器将代码中的宏替换为其定义的值。
  ```cpp
  #define PI 3.14159
  ```
  在代码中，所有出现 `PI` 的地方都会被替换成 `3.14159`。

- **`const`**: 是一个用于定义常量的关键字，常量有类型。
  ```cpp
  const double PI = 3.14159;
  ```
  这里 `PI` 是一个类型为 `double` 的常量。

## 2. 类型安全
- **`#define`**: 没有类型检查。由于是简单的文本替换，预处理器不会检查 `#define` 定义的值的类型。
- **`const`**: 有类型检查。编译器会确保使用 `const` 定义的常量符合其类型，避免类型错误。

## 3. 调试与作用域
- **`#define`**: 在调试时，调试器不会显示 `#define` 定义的宏，因为它们在预处理阶段就被替换掉了。此外，`#define` 定义的宏是全局的，对代码中的所有部分都有效。
- **`const`**: `const` 常量有作用域，可以是局部的或全局的。调试时，调试器可以看到 `const` 变量及其值。

## 4. 内存占用
- **`#define`**: 宏替换后，不存在实际的内存分配。
- **`const`**: 常量在内存中占据空间（通常编译器会优化，只分配一次或将其嵌入代码中）。

## 5. 表达式与类型的使用
- **`#define`**: 可以用于定义表达式，但在替换时要注意运算优先级问题。
  ```cpp
  #define SQUARE(x) x * x
  ```
  使用 `SQUARE(1+2)` 会得到 `1 + 2 * 1 + 2`，这可能不是你想要的结果。

- **`const`**: 可以用来定义类型明确的表达式：
  ```cpp
  const int SQUARE = (1 + 2) * (1 + 2);
  ```

## 6. `const` 结合指针
- **`const`**: 可以与指针结合使用，来定义指针常量或指向常量的指针：
  ```cpp
  const int* ptr; // 指向常量的指针
  int* const ptr; // 指针常量
  const int* const ptr; // 指向常量的指针常量
  ```

总结来说，`const` 提供了类型安全、作用域控制和更好的调试支持，而 `#define` 则是简单的文本替换。推荐在 C++ 中使用 `const` 来定义常量，以获得更强的类型检查和安全性。
